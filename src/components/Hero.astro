<section class="relative w-screen h-screen flex flex-col justify-end items-center overflow-hidden">
  <div id="model-3d-container" class="absolute inset-0 w-full h-full z-0"></div>

  <div class="relative w-full h-auto z-10 flex flex-col gap-2 p-2 text-center pb-8 text-gray-800">
    <h1 class="text-2xl lg:text-5xl font-bold">
      Luisa Fernanda Giraldo Murillo
    </h1>
    <p class="pb-8">
      Mag√≠ster Interdisciplinar en Teatro y Artes Vivas y estudiante del Doctorado en Arte y Arquitectura
    </p>
  </div>
</section>

<script type="module">
  import { initGLBScene } from '/src/scripts/load-glb-model.js';

  (async () => {
    const container = document.getElementById('model-3d-container');
    console.log('[Hero] Container encontrado:', !!container);
    
    if (!container) {
      console.error('[Hero] No se encontr√≥ el contenedor');
      return;
    }

    // Asegurar que el contenedor ocupe toda la ventana
    container.style.position = 'fixed';
    container.style.top = '0';
    container.style.left = '0';
    container.style.width = '100vw';
    container.style.height = '100vh';
    container.style.zIndex = '0';

    console.log('[Hero] Contenedor configurado para viewport completo');

    try {
     function getCorrectBasePath() {
  const hostname = window.location.hostname;
  const pathname = window.location.pathname;
  
  console.log('[Hero] Hostname:', hostname, 'Pathname:', pathname);
  
  // En desarrollo local (localhost o 127.0.0.1)
  if (hostname === 'localhost' || hostname === '127.0.0.1') {
    return '';  // ‚Üê Cambio: retornar string vac√≠o en local
  }
  
  // En GitHub Pages para username.github.io (sin subdirectorio)
  if (hostname === 'riografia.github.io' && pathname === '/') {
    return '';  // ‚Üê Cambio: usuario.github.io no necesita base path
  }
  
  // Fallback para otros casos
  return '';
}

const basePath = getCorrectBasePath();
const modelPath = `${basePath}/models/mapa-colombia.glb`.replace(/\/+/g, '/');

console.log('[Hero] Base path detectado:', basePath);
console.log('[Hero] Ruta final del modelo:', modelPath);

      
      const scene = await initGLBScene(container, modelPath);
      window.threeScene = scene;
      
      console.log('[Hero] ‚úÖ Escena 3D inicializada correctamente');
      console.log('[Hero] üé¨ Animaciones activas:', scene.animations?.length || 0);
      
      // Mostrar informaci√≥n de estado mejorada
      setTimeout(() => {
        const statusInfo = document.createElement('div');
        statusInfo.style.cssText = `
          position: fixed;
          top: 20px;
          left: 20px;
          background: rgba(0, 0, 0, 0.9);
          color: white;
          padding: 20px;
          border-radius: 10px;
          font-family: monospace;
          font-size: 13px;
          z-index: 50;
          max-width: 350px;
          line-height: 1.5;
          border-left: 4px solid #00ff00;
        `;
        
        statusInfo.innerHTML = `
          <strong>üé¨ Estado del Modelo 3D:</strong><br>
          ‚Ä¢ <strong>Escala:</strong> 8x m√°s grande<br>
          ‚Ä¢ <strong>Viewport:</strong> ${window.innerWidth}x${window.innerHeight}<br>
          ‚Ä¢ <strong>Animaciones:</strong> ${scene.animations?.length || 0} detectadas<br>
          ‚Ä¢ <strong>Controles:</strong> Click izq: rotar | Rueda: zoom | Click der: pan<br>
          <hr style="border: 1px solid rgba(255,255,255,0.3); margin: 10px 0;">
          <small><strong>üìù Tip:</strong> Si no ves animaciones, el modelo GLB podr√≠a no tenerlas exportadas correctamente desde Blender</small>
        `;
        container.appendChild(statusInfo);
        
        // Desvanecer despu√©s de 12 segundos
        setTimeout(() => {
          statusInfo.style.transition = 'opacity 3s';
          statusInfo.style.opacity = '0';
          setTimeout(() => {
            if (container.contains(statusInfo)) {
              container.removeChild(statusInfo);
            }
          }, 3000);
        }, 12000);
      }, 1000);
      
    } catch (err) {
      console.error('[Hero] ‚ùå Error al inicializar escena 3D:', err);
      
      const basePath = window.location.hostname === 'localhost' ? '/' : '/riografa.github.io/';
      const expectedPath = `${window.location.origin}${basePath}models/mapa-colombia.glb`.replace(/\/+/g, '/');
      
      const errorEl = document.createElement('div');
      errorEl.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(255, 0, 0, 0.95);
        color: white;
        padding: 25px;
        border-radius: 10px;
        text-align: left;
        z-index: 100;
        max-width: 90%;
        font-family: 'Courier New', monospace;
        font-size: 14px;
        line-height: 1.4;
        border: 2px solid #ff6b6b;
      `;
      
      errorEl.innerHTML = `
        <h3 style="margin: 0 0 15px 0; color: #ffcccb;">‚ùå Error cargando modelo 3D</h3>
        <p><strong>Error:</strong> ${err.message}</p>
        <hr style="margin: 15px 0; border: 1px solid rgba(255,255,255,0.3);">
        <p><strong>Buscando modelo en:</strong><br><code>${expectedPath}</code></p>
        <hr style="margin: 15px 0; border: 1px solid rgba(255,255,255,0.3);">
        <p><strong>‚úÖ Verificar:</strong></p>
        <ol style="margin: 10px 0; padding-left: 20px;">
          <li>Archivo existe en: <code>/public/models/mapa-colombia.glb</code></li>
          <li>Archivo no est√° corrupto</li>
          <li>Deploy exitoso en GitHub Pages</li>
        </ol>
      `;
      container.appendChild(errorEl);
    }
  })();

  // Limpieza al salir de la p√°gina
  window.addEventListener('beforeunload', () => {
    const scene = window.threeScene;
    if (scene && scene.dispose) {
      scene.dispose();
    }
  });
</script>
